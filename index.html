<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Widget Builder</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&family=M+PLUS+Rounded+1c&family=Kosugi+Maru&family=Shippori+Mincho+B1&family=Zen+Maru+Gothic&family=Noto+Serif+JP&display=swap" rel="stylesheet">
  <style>
  body {
    margin: 0;
    display: flex;
    height: 100vh;
    font-family: 'Noto Sans JP', sans-serif;
    background: #edf0f5;
  }
  .sidebar {
    width: 340px;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(10px);
    padding: 30px;
    box-sizing: border-box;
    border-right: 1px solid rgba(200, 200, 200, 0.4);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 30px;
    box-shadow: 4px 0 10px rgba(0,0,0,0.05);
  }
  .card {
    background: rgba(255, 255, 255, 0.9);
    border-radius: 20px;
    box-shadow: 0 6px 20px rgba(0,0,0,0.1);
    padding: 24px;
  }
  .main {
    flex-grow: 1;
    background: #ffffff;
    display: flex;
    justify-content: center;
    align-items: center;
    padding: 60px;
  }
  .widget {
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    background-color: #191970;
    color: #ffffff;
    width: 300px;
    height: 150px;
    border-radius: 20px;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2);
  }
  label {
    display: block;
    margin-bottom: 8px;
    font-size: 15px;
    font-weight: 600;
    color: #333;
  }
  input, select {
  width: 100%;
  box-sizing: border-box; /* ★ここ追加！ */
  padding: 12px 14px;
  font-size: 15px;
  margin-bottom: 20px;
  border: 1px solid #ccc;
  border-radius: 12px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.05);
  background: rgba(255,255,255,0.8);
  backdrop-filter: blur(4px);
  outline: none;
}
.color-swatch {
  width: 30px;
  height: 30px;
  border-radius: 8px;
  cursor: pointer;
  border: 1px solid #ccc;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.color-swatch:hover {
  border: 2px solid #555;
}
.color-swatch {
  width: 30px;
  height: 30px;
  border-radius: 8px;
  cursor: pointer;
  border: 1px solid #ccc;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}
.color-swatch:hover {
  border: 2px solid #555;
}
#colorPopup {
  animation: fadeIn 0.2s ease;
}
@keyframes fadeIn {
  from {opacity: 0; transform: translateY(-10px);}
  to {opacity: 1; transform: translateY(0);}
}


    
</style>


</head>
<body>

  <div class="sidebar">
  <div class="card">
  <h2>ウィジェット設定</h2>

  <!-- テキスト入力 -->
  <label for="text">テキスト</label>
  <textarea id="text" rows="4" style="width:100%; padding:12px 14px; font-size:15px; border-radius:12px; border:1px solid #ccc; margin-bottom:20px; box-sizing:border-box;"></textarea>

  <!-- 文字サイズ -->
  <label for="fontSize">文字サイズ(px)</label>
  <input type="number" id="fontSize" value="24">

  <!-- フォント選択 -->
  <label>フォント</label>
  <div style="position: relative;">
    <button id="toggleFontList" style="width: 100%; padding: 12px 14px; border: 1px solid #ccc; border-radius: 12px; background: white; cursor: pointer; font-size: 15px; text-align: left;">
      ▶︎ フォントを選ぶ
    </button>

    <ul id="fontList" style="list-style: none; padding: 0; margin: 0; display: none; position: absolute; top: 100%; left: 0; width: 100%; background: white; border: 1px solid #ccc; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); z-index: 10;">
      <li data-font="'Noto Sans JP', sans-serif" style="padding: 12px; cursor: pointer; font-family: 'Noto Sans JP', sans-serif;">Noto Sans JP<br><span style="font-size: 12px; color: #999;">文字もじモジ</span></li>
      <li data-font="'M PLUS Rounded 1c', sans-serif" style="padding: 12px; cursor: pointer; font-family: 'M PLUS Rounded 1c', sans-serif;">M PLUS Rounded 1c<br><span style="font-size: 12px; color: #999;">文字もじモジ</span></li>
      <li data-font="'Kosugi Maru', sans-serif" style="padding: 12px; cursor: pointer; font-family: 'Kosugi Maru', sans-serif;">Kosugi Maru<br><span style="font-size: 12px; color: #999;">文字もじモジ</span></li>
      <li data-font="'Shippori Mincho', serif" style="padding: 12px; cursor: pointer; font-family: 'Shippori Mincho', serif;">Shippori Mincho<br><span style="font-size: 12px; color: #999;">文字もじモジ</span></li>
      <li data-font="'Zen Maru Gothic', sans-serif" style="padding: 12px; cursor: pointer; font-family: 'Zen Maru Gothic', sans-serif;">Zen Maru Gothic<br><span style="font-size: 12px; color: #999;">文字もじモジ</span></li>
    </ul>
  </div>

  <!-- 背景色 -->
  <label for="bgColor">背景色</label>
<div style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px; position: relative;">
  
  <!-- カラーコード入力欄 -->
  <input type="text" id="bgColor" value="#FFFFFF" style="flex: 1; padding: 10px; font-size: 14px; border-radius: 8px; border: 1px solid #ccc; box-sizing: border-box;">
  
  <!-- 色プレビューボックス -->
  <div id="bgColorPreview" style="width: 30px; height: 30px; border-radius: 8px; background: #FFFFFF; border: 1px solid #ccc; cursor: pointer;"></div>
  
  <!-- カラーパレットポップアップ -->
  <div id="colorPopup" style="display: none; position: absolute; top: 50px; right: 0; background: white; border: 1px solid #ccc; border-radius: 12px; padding: 16px; box-shadow: 0 8px 20px rgba(0,0,0,0.15); z-index: 100;">
    <input type="color" id="bgColorPicker" value="#FFFFFF" style="width: 100%; height: 40px; border: none; margin-bottom: 12px;">

    <div style="display: flex; flex-wrap: wrap; gap: 8px;">
      <div class="color-swatch" style="background: #FFFFFF;" data-color="#FFFFFF" title="Default"></div>
      <div class="color-swatch" style="background: #F1F1EF;" data-color="#F1F1EF" title="Gray background"></div>
      <div class="color-swatch" style="background: #F4EEEE;" data-color="#F4EEEE" title="Brown background"></div>
      <div class="color-swatch" style="background: #FBECDD;" data-color="#FBECDD" title="Orange background"></div>
      <div class="color-swatch" style="background: #FBF3DB;" data-color="#FBF3DB" title="Yellow background"></div>
      <div class="color-swatch" style="background: #EDF3EC;" data-color="#EDF3EC" title="Green background"></div>
      <div class="color-swatch" style="background: #E7F3F8;" data-color="#E7F3F8" title="Blue background"></div>
      <div class="color-swatch" style="background: #F6F3F9;" data-color="#F6F3F9" title="Purple background"></div>
      <div class="color-swatch" style="background: #fdebec;" data-color="#fdebec" title="Pink background"></div>
      <div class="color-swatch" style="background: #FBE4E4;" data-color="#FBE4E4" title="Red background"></div>
    </div>
  </div>

</div>



  <input type="color" id="bgColor" value="#191970">

  <!-- 文字色 -->
  <label for="textColor">文字色</label>
  <input type="color" id="textColor" value="#ffffff">

  <!-- 形 -->
  <label for="shape">形</label>
  <select id="shape">
    <option value="square">四角</option>
    <option value="rounded">丸みあり</option>
  </select>

  <!-- 幅と高さ -->
  <label for="width">幅(px)</label>
  <input type="number" id="width" value="300">
  <label for="height">高さ(px)</label>
  <input type="number" id="height" value="150">

  <!-- リンク表示 -->
  <div style="margin-top: 30px;">
    <h3>このウィジェットのリンク</h3>
    <input type="text" id="generatedUrl" style="width: 100%; font-size: 14px; padding: 8px;" readonly>
  </div>

</div>

  </div>
</div>
  

  <div class="main">
    <div class="widget" id="widget">
      こんにちは
    </div>
  </div>

  <script>
    let selectedFontFamily = "'Noto Sans JP', sans-serif";
const widget = document.getElementById('widget');

function updateWidget() {
  const text = document.getElementById('text').value;
  const bgColor = document.getElementById('bgColor').value;
  const textColor = document.getElementById('textColor').value;
  const shape = document.getElementById('shape').value;
  const width = document.getElementById('width').value;
  const height = document.getElementById('height').value;
  const fontSize = document.getElementById('fontSize').value;
  const fontFamily = selectedFontFamily;

  widget.innerHTML = text.replace(/\n/g, '<br>');  // 改行対応
  widget.style.backgroundColor = bgColor;
  widget.style.color = textColor;
  widget.style.width = width + 'px';
  widget.style.height = height + 'px';
  widget.style.fontSize = fontSize + 'px';
  widget.style.fontFamily = fontFamily;
  widget.style.borderRadius = shape === 'rounded' ? '16px' : '0px';

  const baseUrl = window.location.origin + window.location.pathname.replace('index.html', 'widget.html');
  const url = `${baseUrl}?text=${encodeURIComponent(text)}&bgColor=${encodeURIComponent(bgColor)}&textColor=${encodeURIComponent(textColor)}&shape=${shape}&width=${width}&height=${height}&fontSize=${fontSize}&fontFamily=${encodeURIComponent(fontFamily)}`;
  document.getElementById('generatedUrl').value = url;
}

// フォントリスト開閉＋矢印切り替え
const toggleBtn = document.getElementById('toggleFontList');
toggleBtn.addEventListener('click', () => {
  const fontList = document.getElementById('fontList');
  if (fontList.style.display === 'none') {
    fontList.style.display = 'block';
    toggleBtn.innerHTML = "▼ フォントを選ぶ";
  } else {
    fontList.style.display = 'none';
    toggleBtn.innerHTML = "▶︎ フォントを選ぶ";
  }
});

// フォント選択（リストは閉じない）
document.querySelectorAll('#fontList li').forEach(li => {
  li.addEventListener('click', () => {
    const fontFamily = li.getAttribute('data-font');
    selectedFontFamily = fontFamily;
    widget.style.fontFamily = fontFamily;

    // ハイライト
    document.querySelectorAll('#fontList li').forEach(item => {
      item.style.background = 'transparent';
    });
    li.style.background = '#eef2f7';
    
    updateWidget();
  });
});

window.addEventListener('DOMContentLoaded', () => {
  document.querySelectorAll('input, select, textarea').forEach(el => {
    el.addEventListener('input', updateWidget);
    el.addEventListener('change', updateWidget);
  });

  updateWidget();


});

// 色のボタンを押したらテキストボックスに反映
document.querySelectorAll('.color-swatch').forEach(swatch => {
  swatch.addEventListener('click', () => {
    const color = swatch.getAttribute('data-color');
    document.getElementById('bgColor').value = color;
    updateWidget(); // ウィジェット更新
  });
});

// テキスト入力でもリアルタイム反映
document.getElementById('bgColor').addEventListener('input', updateWidget);

// カラーコードを変更したらプレビューとウィジェットに反映
document.getElementById('bgColor').addEventListener('input', () => {
  const color = document.getElementById('bgColor').value;
  document.getElementById('bgColorPreview').style.background = color;
  updateWidget();
});

// 色プレビューをクリックしたらカラーピッカー開く
document.getElementById('bgColorPreview').addEventListener('click', () => {
  document.getElementById('bgColorPicker').click();
});

// カラーピッカーで色選んだらコードにも反映
document.getElementById('bgColorPicker').addEventListener('input', () => {
  const color = document.getElementById('bgColorPicker').value;
  document.getElementById('bgColor').value = color;
  document.getElementById('bgColorPreview').style.background = color;
  updateWidget();
});

// デフォルト色ボタンから選んだとき
document.querySelectorAll('.color-swatch').forEach(swatch => {
  swatch.addEventListener('click', () => {
    const color = swatch.getAttribute('data-color');
    document.getElementById('bgColor').value = color;
    document.getElementById('bgColorPreview').style.background = color;
    updateWidget();
  });
});
// 背景色：カラーコード打ち込みで更新
document.getElementById('bgColor').addEventListener('input', () => {
  const color = document.getElementById('bgColor').value;
  document.getElementById('bgColorPreview').style.background = color;
  updateWidget();
});

// 色プレビュークリックでポップアップ開く/閉じる
document.getElementById('bgColorPreview').addEventListener('click', (e) => {
  e.stopPropagation();
  const popup = document.getElementById('colorPopup');
  popup.style.display = popup.style.display === 'block' ? 'none' : 'block';
});

// ページ全体をクリックしたらポップアップを閉じる
document.addEventListener('click', (e) => {
  const popup = document.getElementById('colorPopup');
  if (!e.target.closest('#colorPopup') && !e.target.closest('#bgColorPreview')) {
    popup.style.display = 'none';
  }
});

// カラーピッカーで選択したら反映
document.getElementById('bgColorPicker').addEventListener('input', () => {
  const color = document.getElementById('bgColorPicker').value;
  document.getElementById('bgColor').value = color;
  document.getElementById('bgColorPreview').style.background = color;
  updateWidget();
});

// Notion色ボタン選択
document.querySelectorAll('.color-swatch').forEach(swatch => {
  swatch.addEventListener('click', () => {
    const color = swatch.getAttribute('data-color');
    document.getElementById('bgColor').value = color;
    document.getElementById('bgColorPreview').style.background = color;
    document.getElementById('bgColorPicker').value = color;
    updateWidget();
  });
});





  </script>

</body>
</html>
